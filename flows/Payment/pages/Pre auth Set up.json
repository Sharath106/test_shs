{
  "name": "61efe10d-cbd9-4250-9e57-148115da5d77",
  "displayName": "Pre auth Set up",
  "form": {
    "parameters": [ {
      "displayName": "phone_online_pre_auth_setup",
      "required": true,
      "entityType": "@phone-or-online",
      "fillBehavior": {
        "initialPromptFulfillment": {
        
        },
        "repromptEventHandlers": [ {
          "event": "sys.no-match-1",
          "triggerFulfillment": {
            "messages": [ {
              "text": {
                "text": [ "Désolé, je ne pense pas avoir compris.", "Désolé, je n'ai pas tout à fait compris.", "Je ne crois pas avoir bien saisi." ]
              },
              "languageCode": "fr-ca"
            }, {
              "text": {
                "text": [ "Aimeriez-vous continuer par téléphone, ou que je vous envoi les instructions pour le faire par vous-même?" ]
              },
              "languageCode": "fr-ca"
            }, {
              "text": {
                "text": [ "Sorry, I didn’t understand that.", "Sorry, I didn't catch that.", "I didn't get that." ]
              },
              "languageCode": "en"
            }, {
              "text": {
                "text": [ "Would you prefer to receive a text with more information on how to setup pre-authorization payment or do you want to continue over the phone?" ]
              },
              "languageCode": "en"
            } ]
          },
          "name": "d6310f2a-804d-4847-9b38-6290ff3ba9e8"
        }, {
          "event": "sys.no-match-2",
          "triggerFulfillment": {
            "messages": [ {
              "text": {
                "text": [ "Pour continuer par téléphone, dites oui ou faites le 1. Pour recevoir un message texte, dites oui ou faites le 9. Membre de l'équipe, ou faites le 0." ]
              },
              "languageCode": "fr-ca"
            }, {
              "text": {
                "text": [ "To continue over the phone, say yes or press 1. Receive a text or press 9, team member or press 0." ]
              },
              "languageCode": "en"
            } ]
          },
          "name": "a7875928-81de-4b13-8951-c17ebbfd6845"
        }, {
          "targetPage": "No Match 2",
          "event": "sys.no-match-3",
          "triggerFulfillment": {
          
          },
          "name": "3ce966b3-c084-4c05-bde1-96879ec2e975"
        }, {
          "event": "sys.no-input-1",
          "triggerFulfillment": {
            "messages": [ {
              "text": {
                "text": [ "Désolé, je ne pense pas avoir compris.", "Désolé, je n'ai pas tout à fait compris.", "Je ne crois pas avoir bien saisi." ]
              },
              "languageCode": "fr-ca"
            }, {
              "text": {
                "text": [ "Aimeriez-vous continuer par téléphone, ou que je vous envoi les instructions pour le faire par vous-même?" ]
              },
              "languageCode": "fr-ca"
            }, {
              "text": {
                "text": [ "Sorry, I didn’t understand that.", "Sorry, I didn't catch that.", "I didn't get that." ]
              },
              "languageCode": "en"
            }, {
              "text": {
                "text": [ "Would you prefer to receive a text with more information on how to setup pre-authorization payment or do you want to continue over the phone?" ]
              },
              "languageCode": "en"
            } ]
          },
          "name": "72ea7752-e496-431d-8a83-68a8113568d8"
        }, {
          "event": "sys.no-input-2",
          "triggerFulfillment": {
            "messages": [ {
              "text": {
                "text": [ "Pour continuer par téléphone, dites oui ou faites le 1. Pour recevoir un message texte, dites oui ou faites le 9. Membre de l'équipe, ou faites le 0." ]
              },
              "languageCode": "fr-ca"
            }, {
              "text": {
                "text": [ "To continue over the phone, say yes or press 1. receive a text or press 9, team member or press 0." ]
              },
              "languageCode": "en"
            } ]
          },
          "name": "3c2396e5-1393-438e-ba12-278f53ea56bb"
        }, {
          "targetPage": "No Match 2",
          "event": "sys.no-input-3",
          "triggerFulfillment": {
          
          },
          "name": "421ee113-882d-4186-bf04-12278dc677f1"
        } ]
      },
      "advancedSettings": {
        "dtmfSettings": {
          "enabled": true,
          "maxDigits": 1,
          "useSystemEntityRule": false,
          "endpointingTimeoutDuration": {
            "seconds": 8
          }
        }
      }
    } ]
  },
  "entryFulfillment": {
    "setParameterActions": [ {
      "parameter": "last_page",
      "value": "Pre auth Set up"
    }, {
      "parameter": "sms_flow_status",
      "value": "offered"
    }, {
      "parameter": "page_summary",
      "value": "setting up pre authorized payments"
    }, {
      "parameter": "page_summaryfr",
      "value": "la mise en place de paiements préautorisés"
    }, {
      "parameter": "phone_online_pre_auth_setup",
      "value": "app"
    } ],
    "conditionalCases": [ {
      "cases": [ {
        "condition": "$session.params.payment_method_action = \"remove\"",
        "caseContent": [ {
          "message": {
            "text": {
              "text": [ "Je peux certainement vous aider à annuler vos paiements préautorisés." ]
            },
            "languageCode": "fr-ca"
          }
        }, {
          "message": {
            "text": {
              "text": [ "I can definitely help you remove your pre-authorized payments." ]
            },
            "languageCode": "en"
          }
        } ]
      }, {
        "caseContent": [ {
          "message": {
            "text": {
              "text": [ "Je peux certainement vous aider à gérer vos paiements préautorisés." ]
            },
            "languageCode": "fr-ca"
          }
        }, {
          "message": {
            "text": {
              "text": [ "I can definitely help you manage your pre-authorized payments." ]
            },
            "languageCode": "en"
          }
        } ]
      } ]
    } ]
  },
  "transitionRoutes": [ {
    "intent": "small_talk.confirmation_yes",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "preauthsetup_retrycnt",
        "value": null
      }, {
        "parameter": "phone_online_pre_auth_setup",
        "value": null
      }, {
        "parameter": "handoff_type",
        "value": "self_serve"
      } ]
    },
    "targetFlow": "Universal handoff",
    "name": "e202b6eb-e21c-4a5a-a2ae-d2126bb1c650"
  }, {
    "intent": "small_talk.confirmation_no",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "preauthsetup_retrycnt",
        "value": null
      }, {
        "parameter": "phone_online_pre_auth_setup",
        "value": null
      }, {
        "parameter": "sms_flow_status",
        "value": "declined"
      }, {
        "parameter": "sms_template",
        "value": "0009SaHN7319015H"
      }, {
        "parameter": "sms_template_fr",
        "value": "0009SaHN731900AH"
      }, {
        "parameter": "sms_flow_option",
        "value": "app"
      } ]
    },
    "targetPage": "End page",
    "name": "a39785b2-e344-4128-a219-d1ea17ca252c"
  }, {
    "intent": "small_talk.nevermind",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "preauthsetup_retrycnt",
        "value": null
      }, {
        "parameter": "phone_pnline_pre_auth_setup",
        "value": null
      }, {
        "parameter": "sms_flow_status",
        "value": "declined"
      }, {
        "parameter": "sms_flow_option",
        "value": "app"
      }, {
        "parameter": "sms_template",
        "value": "0009SaHN7319015H"
      }, {
        "parameter": "sms_template_fr",
        "value": "0009SaHN731900AH"
      } ]
    },
    "targetPage": "End page",
    "name": "3aaee018-ba1d-4c0f-8ef6-bd89024b19ae"
  }, {
    "intent": "supplemental.sendtxt",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "preauthsetup_retrycnt",
        "value": null
      }, {
        "parameter": "phone_online_pre_auth_setp",
        "value": null
      }, {
        "parameter": "sms_flow_status",
        "value": "accepted"
      } ]
    },
    "targetPage": "Pre auth Set up online or app",
    "name": "0a064a15-4a97-4a49-89c2-e9651eabc604"
  }, {
    "condition": "$session.params.phone_online_pre_auth_setup = \"1\" OR $session.params.phone_online_pre_auth_setup = phone",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "preauthsetup_retrycnt",
        "value": null
      }, {
        "parameter": "phone_online_pre_auth_setup",
        "value": null
      }, {
        "parameter": "handoff_type",
        "value": "self_serve"
      } ]
    },
    "targetFlow": "Universal handoff",
    "name": "6e2c1813-402b-484d-8470-63bdff153afa"
  }, {
    "condition": "$session.params.phone_online_pre_auth_setup = \"9\" OR $session.params.phone_online_pre_auth_setup = \"online\" OR $session.params.phone_online_pre_auth_setup = \"app\"",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "preauthsetup_retrycnt",
        "value": null
      }, {
        "parameter": "phone_online_pre_auth_setup",
        "value": null
      }, {
        "parameter": "sms_flow_status",
        "value": "accepted"
      } ]
    },
    "targetPage": "Pre auth Set up online or app",
    "name": "bfae9ddf-ee24-4650-8557-d9cb94e06e18"
  }, {
    "condition": "$session.params.phone_online_pre_auth_setup = \"0\"",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "D'accord, laissez-moi chercher quelqu'un pour vous aider." ]
        },
        "languageCode": "fr-ca"
      }, {
        "text": {
          "text": [ "Alright, let's get someone to help you." ]
        },
        "languageCode": "en"
      } ],
      "setParameterActions": [ {
        "parameter": "preauthsetup_retrycnt",
        "value": null
      }, {
        "parameter": "phone_online_pre_auth_setup",
        "value": null
      } ]
    },
    "targetFlow": "Universal handoff",
    "name": "9e6e329c-1677-44ec-bc3f-44cbce0cafca"
  }, {
    "condition": "$session.params.preauthsetup_retrycnt = null",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "preauthsetup_retrycnt",
        "value": 0
      } ]
    },
    "name": "7c759532-eded-45ce-9709-4dd04c0c2957"
  }, {
    "condition": "$session.params.preauthsetup_retrycnt \u003e 2",
    "triggerFulfillment": {
    
    },
    "targetPage": "No Match 2",
    "name": "add177a6-745f-47c3-b5a7-f67cf7c081b8"
  }, {
    "condition": "$session.params.phone_online_pre_auth_setup = 3",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "Désolé, je ne pense pas avoir compris.", "Désolé, je n'ai pas tout à fait compris.", "Je ne crois pas avoir bien saisi." ]
        },
        "languageCode": "fr-ca"
      }, {
        "text": {
          "text": [ "I'm Sorry, I didn’t understand that.", "Sorry, I didn't catch that.", "I didn't get that." ]
        },
        "languageCode": "en"
      } ],
      "setParameterActions": [ {
        "parameter": "phone_online_pre_auth_setup",
        "value": null
      }, {
        "parameter": "preauthsetup_retrycnt",
        "value": "$sys.func.ADD($session.params.preauthsetup_retrycnt,1)"
      } ]
    },
    "targetPage": "Current Page",
    "name": "5924c2bc-726d-4f6e-a9b9-59816eedab34"
  } ],
  "eventHandlers": [ {
    "targetPage": "Current Page",
    "event": "NO_INPUT",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "preauthsetup_retrycnt",
        "value": "$sys.func.ADD($session.params.preauthsetup_retrycnt,1)"
      } ],
      "conditionalCases": [ {
        "cases": [ {
          "condition": "$session.params.preauthsetup_retrycnt = 0",
          "caseContent": [ {
            "message": {
              "text": {
                "text": [ "Désolé, je ne crois pas avoir bien saisi." ]
              },
              "languageCode": "fr-ca"
            }
          }, {
            "message": {
              "text": {
                "text": [ "Sorry, I didn't quite get that." ]
              },
              "languageCode": "en"
            }
          } ]
        }, {
          "condition": "$session.params.preauthsetup_retrycnt = 1",
          "caseContent": [ {
            "message": {
              "text": {
                "text": [ "Désolé, je n'ai pas tout à fait compris." ]
              },
              "languageCode": "fr-ca"
            }
          }, {
            "message": {
              "text": {
                "text": [ "Sorry, I didn't catch that." ]
              },
              "languageCode": "en"
            }
          } ]
        } ]
      } ]
    },
    "name": "fb66ebf2-9642-488e-9aad-32a4abf430cb"
  } ],
  "transitionRouteGroups": [ "Supp_route_payment" ]
}
