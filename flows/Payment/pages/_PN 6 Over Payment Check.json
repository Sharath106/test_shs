{
  "name": "88ef2389-70ba-4fb5-8456-8d3d3396db84",
  "displayName": "_PN 6 Over Payment Check",
  "form": {
  
  },
  "entryFulfillment": {
    "setParameterActions": [ {
      "parameter": "last_page",
      "value": "_PN 6 Over Payment Check"
    }, {
      "parameter": "payment_amount",
      "value": "$session.params.pay_now_amount"
    } ]
  },
  "transitionRoutes": [ {
    "intent": "small_talk.confirmation_yes",
    "condition": "$session.params.is_under_payment = true",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "payment_amount",
        "value": "$sys.func.TO_NUMBER($session.params.pay_now_amount)"
      } ]
    },
    "targetPage": "_PN 10 Set Params",
    "name": "fb728bc4-3249-40d7-9c75-5097c43fd75e"
  }, {
    "intent": "small_talk.confirmation_no",
    "condition": "$session.params.is_under_payment = true",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "pay_now_amount",
        "value": null
      }, {
        "parameter": "under_payment_counter",
        "value": "$sys.func.ADD($session.params.under_payment_counter, 1)"
      }, {
        "parameter": "payment_amount",
        "value": null
      } ]
    },
    "targetPage": "_PN Check Conditions",
    "name": "1f638aa4-1e3c-4ba0-8997-e86385dbff57"
  }, {
    "intent": "small_talk.continue",
    "condition": "$session.params.is_under_payment = true",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "payment_amount",
        "value": "$sys.func.TO_NUMBER($session.params.pay_now_amount)"
      } ]
    },
    "targetPage": "_PN 10 Set Params",
    "name": "e25dab9a-7687-48aa-806e-41c8ededc41f"
  }, {
    "intent": "small_talk.choose_different_amount",
    "condition": "$session.params.is_under_payment = true",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "pay_now_amount",
        "value": null
      }, {
        "parameter": "under_payment_counter",
        "value": "$sys.func.ADD($session.params.under_payment_counter, 1)"
      }, {
        "parameter": "payment_amount",
        "value": null
      } ]
    },
    "targetPage": "_PN Check Conditions",
    "name": "7a0a63cf-1b6c-4389-b4e8-d7dc928abd1c"
  }, {
    "condition": "$session.params.over_payment_counter = 0 OR $session.params.over_payment_counter = null",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "over_payment_counter",
        "value": 0
      } ]
    },
    "name": "c066a5cc-3e3b-48c9-8389-bb76aac089a6"
  }, {
    "condition": "$session.params.under_payment_counter = 0 OR $session.params.under_payment_counter = null",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "under_payment_counter",
        "value": 0
      } ]
    },
    "name": "7a120cff-d688-44b8-84f3-e26792faa631"
  }, {
    "condition": "$session.params.pay_now_amount \u003c $session.params.total_due",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "\u003cspeak\u003eYour current balance is \u003csay-as interpret-as=\"currency\" language='en-US'\u003e$$session.params.total_due\u003c/say-as\u003e but you selected to pay \u003csay-as interpret-as=\"currency\" language='en-US'\u003e$$session.params.pay_now_amount\u003c/say-as\u003e, which is less than the amount owed.\u003c/speak\u003e" ]
        },
        "languageCode": "en"
      }, {
        "text": {
          "text": [ "Please note that if you make a partial payment, late payments could be applied to your account. Would you like to continue with this payment amount or pay a different amount?" ]
        },
        "languageCode": "en"
      }, {
        "text": {
          "text": [ "\u003cspeak\u003eVotre solde actuel est de \u003csay-as interpret-as=\"currency\" language='fr'\u003e$$session.params.total_due\u003c/say-as\u003e, mais vous avez choisi de payer \u003csay-as interpret-as=\"currency\" language='fr'\u003e$$session.params.pay_now_amount\u003c/say-as\u003e, ce qui est inférieur au montant dû.\u003c/speak\u003e" ]
        },
        "languageCode": "fr-ca"
      }, {
        "text": {
          "text": [ "Veuillez noter que si vous faites un paiement partiel, des frais de retard pourraient être appliqués à votre compte. Aimeriez-vous continuer avec ce montant ou payer un montant différent?" ]
        },
        "languageCode": "fr-ca"
      } ],
      "setParameterActions": [ {
        "parameter": "is_under_payment",
        "value": true
      } ]
    },
    "name": "714ed54e-8474-409e-b20e-65887be27623"
  }, {
    "condition": "$session.params.pay_now_amount = $session.params.total_due",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "payment_amount",
        "value": "$sys.func.TO_NUMBER($session.params.pay_now_amount)"
      } ]
    },
    "targetPage": "_PN 10 Set Params",
    "name": "0c7823ec-75a9-471b-9322-46d69d84a5e9"
  }, {
    "condition": "$session.params.pay_now_amount \u003e $session.params.one_time_pay_limit",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "pay_now_amount",
        "value": null
      }, {
        "parameter": "over_payment_counter",
        "value": "$sys.func.ADD($session.params.over_payment_counter, 1)"
      }, {
        "parameter": "payment_amount",
        "value": null
      } ],
      "conditionalCases": [ {
        "cases": [ {
          "condition": "$session.params.over_payment_counter \u003c 3",
          "caseContent": [ {
            "message": {
              "text": {
                "text": [ "\u003cspeak\u003eYour current total balance on the account is \u003csay-as interpret-as=\"currency\" language='en-US'\u003e$$session.params.total_due\u003c/say-as\u003e. The amount you are trying to pay exceeds the maximum payment limit. Please note I can only account for an over payment of 20% of the balance due. \u003c/speak\u003e" ]
              },
              "languageCode": "en"
            }
          }, {
            "message": {
              "text": {
                "text": [ "\u003cspeak\u003eLe solde total actuel de votre compte est de \u003csay-as interpret-as=\"currency\" language='fr'\u003e$$session.params.total_due\u003c/say-as\u003e. Le montant que vous essayez de payer dépasse la limite maximale de paiement. Veuillez noter que je peux seulement prendre en compte les paiements excédentaires de 20% du solde dû.\u003c/speak\u003e" ]
              },
              "languageCode": "fr-ca"
            }
          } ]
        } ]
      } ]
    },
    "targetPage": "_PN Check Conditions",
    "name": "9bb967f3-9090-412d-8b5a-f28f85b9f149"
  }, {
    "condition": "$session.params.pay_now_amount \u003c= $session.params.one_time_pay_limit AND $session.params.pay_now_amount \u003e= $session.params.total_due",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "payment_amount",
        "value": "$sys.func.TO_NUMBER($session.params.pay_now_amount)"
      } ]
    },
    "targetPage": "_PN 10 Set Params",
    "name": "8706502b-8f41-4792-bf46-c507a35aeeed"
  } ],
  "eventHandlers": [ {
    "event": "sys.no-input-1",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "Sorry, I didn’t understand that.", "Sorry, I didn't catch that. ", "I didn't get that." ]
        },
        "languageCode": "en"
      }, {
        "text": {
          "text": [ "\u003cspeak\u003eWould you like to go ahead with paying \u003csay-as interpret-as=\"currency\" language='en-US'\u003e$$session.params.pay_now_amount\u003c/say-as\u003e?\u003c/speak\u003e" ]
        },
        "languageCode": "en"
      }, {
        "text": {
          "text": [ "Je suis désolé, je n'ai pas compris.", "Désolé, je n'ai pas compris.", "Je n'ai pas compris." ]
        },
        "languageCode": "fr-ca"
      }, {
        "text": {
          "text": [ "\u003cspeak\u003eVoulez-vous continuer et payer un montant de \u003csay-as interpret-as=\"currency\" language='fr-ca'\u003e$$session.params.pay_now_amount\u003c/say-as\u003e?\u003c/speak\u003e" ]
        },
        "languageCode": "fr-ca"
      } ]
    },
    "name": "aac35015-fe0e-4f70-abe4-5646e348aed2"
  }, {
    "event": "sys.no-input-2",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "I'm still not sure I got that.", "I still don't quite understand." ]
        },
        "languageCode": "en"
      }, {
        "text": {
          "text": [ "\u003cspeak\u003eWould you like to go ahead with paying \u003csay-as interpret-as=\"currency\" language='en-US'\u003e$$session.params.pay_now_amount\u003c/say-as\u003e?\u003c/speak\u003e" ]
        },
        "languageCode": "en"
      }, {
        "text": {
          "text": [ "Je n'ai toujours pas compris.", "Je n'ai pas bien entendu ce que vous avez dit." ]
        },
        "languageCode": "fr-ca"
      }, {
        "text": {
          "text": [ "\u003cspeak\u003eVoulez-vous continuer et payer un montant de \u003csay-as interpret-as=\"currency\" language='fr-ca'\u003e$$session.params.pay_now_amount\u003c/say-as\u003e?\u003c/speak\u003e" ]
        },
        "languageCode": "fr-ca"
      } ]
    },
    "name": "438360ed-506d-46f1-b7ff-7f18b7fbd0ef"
  }, {
    "targetFlow": "Universal handoff",
    "event": "sys.no-input-3",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "Sorry, I'm still not understanding. Let me transfer you to a team member for more assistance." ]
        },
        "languageCode": "en"
      }, {
        "text": {
          "text": [ "Désolé, je ne comprends toujours pas. Je vais vous transférer à un agent pour de l'assistance." ]
        },
        "languageCode": "fr-ca"
      } ]
    },
    "name": "4d82bfc9-d64b-471f-a4ab-103c062f971e"
  }, {
    "event": "sys.no-match-1",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "I'm sorry, I didn't hear that.", "Sorry, I didn't hear that.", "I didn't catch that." ]
        },
        "languageCode": "en"
      }, {
        "text": {
          "text": [ "\u003cspeak\u003eWould you like to go ahead with paying \u003csay-as interpret-as=\"currency\" language='en-US'\u003e$$session.params.pay_now_amount\u003c/say-as\u003e?\u003c/speak\u003e" ]
        },
        "languageCode": "en"
      }, {
        "text": {
          "text": [ "Je suis désolé, je n'ai pas compris.", "Désolé, je n'ai pas compris.", "Je n'ai pas compris." ]
        },
        "languageCode": "fr-ca"
      }, {
        "text": {
          "text": [ "\u003cspeak\u003eVoulez-vous continuer et payer un montant de \u003csay-as interpret-as=\"currency\" language='fr-ca'\u003e$$session.params.pay_now_amount\u003c/say-as\u003e?\u003c/speak\u003e" ]
        },
        "languageCode": "fr-ca"
      } ]
    },
    "name": "6a37227b-d961-4d2a-888f-5934c390298a"
  }, {
    "event": "sys.no-match-2",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "I still don't quite understand.", "I'm still not sure I got that." ]
        },
        "languageCode": "en"
      }, {
        "text": {
          "text": [ "\u003cspeak\u003eWould you like to go ahead with paying \u003csay-as interpret-as=\"currency\" language='en-US'\u003e$$session.params.pay_now_amount\u003c/say-as\u003e?\u003c/speak\u003e" ]
        },
        "languageCode": "en"
      }, {
        "text": {
          "text": [ "Je n'ai toujours pas compris.", "Je n'ai pas bien entendu ce que vous avez dit." ]
        },
        "languageCode": "fr-ca"
      }, {
        "text": {
          "text": [ "\u003cspeak\u003eVoulez-vous continuer et payer un montant de \u003csay-as interpret-as=\"currency\" language='fr-ca'\u003e$$session.params.pay_now_amount\u003c/say-as\u003e?\u003c/speak\u003e" ]
        },
        "languageCode": "fr-ca"
      } ]
    },
    "name": "ce32dd6c-5423-460b-b0aa-33f7482eedbe"
  }, {
    "targetFlow": "Universal handoff",
    "event": "sys.no-match-3",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "Sorry, I'm still not understanding. Let me transfer you to a team member for more assistance." ]
        },
        "languageCode": "en"
      }, {
        "text": {
          "text": [ "Désolé, je ne comprends toujours pas. Je vais vous transférer à un agent pour de l'assistance." ]
        },
        "languageCode": "fr-ca"
      } ]
    },
    "name": "f69e115c-99c0-4056-8c6c-f7c9ce8e73e2"
  } ]
}
