{
  "name": "3002d394-3265-483b-84fb-e403cd4359cd",
  "displayName": "_PAP 7 PAP Setup Check",
  "form": {
  
  },
  "entryFulfillment": {
    "webhook": "Payment",
    "tag": "retrieve_payment_method",
    "setParameterActions": [ {
      "parameter": "last_page",
      "value": "_PAP 7 PAP Setup Check"
    } ]
  },
  "transitionRoutes": [ {
    "condition": "$session.params.pap_test_mode = true",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "error_code",
        "value": null
      } ]
    },
    "name": "cb7fbfb6-8278-4016-bbe0-dd6eb00b3df2"
  }, {
    "condition": "$session.params.error_code != null AND $session.params.api_delay = \"false\"",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "Please wait, I'm still working on your request." ]
        },
        "languageCode": "en"
      }, {
        "text": {
          "text": [ "Veuillez patienter pendant que je traite votre demande." ]
        },
        "languageCode": "fr-ca"
      } ],
      "webhook": "Payment",
      "tag": "retrieve_payment_method",
      "setParameterActions": [ {
        "parameter": "error_code",
        "value": null
      }, {
        "parameter": "error_retry",
        "value": "1"
      }, {
        "parameter": "api_delay",
        "value": null
      }, {
        "parameter": "error_full_response",
        "value": null
      }, {
        "parameter": "error_api_name",
        "value": null
      } ]
    },
    "name": "85bc120d-2c1b-43fe-b1a4-ca5b9a623a2b"
  }, {
    "condition": "($session.params.error_code != null AND $session.params.error_retry = \"1\") OR ($session.params.api_delay = \"true\" AND $session.params.error_code != null)",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "error_code",
        "value": null
      }, {
        "parameter": "error_retry",
        "value": null
      }, {
        "parameter": "api_delay",
        "value": null
      }, {
        "parameter": "error_full_response",
        "value": null
      }, {
        "parameter": "error_api_name",
        "value": null
      } ]
    },
    "targetPage": "Webhook Error Redirect",
    "name": "ba55ba5c-c46e-4dc0-9f88-0e43423498cd"
  }, {
    "condition": "$session.params.payment_method = \"telusBankAccountDebit\" OR $session.params.payment_method = \"telusTokenizedCard\"",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "is_pap_available",
        "value": true
      } ]
    },
    "name": "6f80a023-b385-4c2c-9e28-0e5f04eb61b2"
  }, {
    "condition": "$session.params.payment_method_action = \"remove\" AND $session.params.is_pap_available = true",
    "triggerFulfillment": {
    
    },
    "targetPage": "_PAP 11 Confirm PAP Removal",
    "name": "50cbad3d-27c2-433f-ade4-265332035382"
  }, {
    "condition": "$session.params.payment_method_action = \"remove\" AND $session.params.is_pap_available != true",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "There is no pre-authorized payment method currently on your account." ]
        },
        "languageCode": "en"
      }, {
        "text": {
          "text": [ "Aucun mode de paiement préautorisé ne figure actuellement à votre compte." ]
        },
        "languageCode": "fr-ca"
      } ]
    },
    "targetPage": "_PAP 9 Propose PAP Setup",
    "name": "425e1f68-c7b4-4b5b-80c1-960a0df23b56"
  }, {
    "condition": "$session.params.payment_method_action = \"retrieve\" AND $session.params.is_pap_available = true",
    "triggerFulfillment": {
    
    },
    "targetPage": "_PAP 10 Display PAP",
    "name": "e557004a-82ff-4b17-8e24-5b09daeecf1c"
  }, {
    "condition": "$session.params.is_pap_available != true",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "There is no pre-authorized payment method currently on your account." ]
        },
        "languageCode": "en"
      }, {
        "text": {
          "text": [ "Aucun mode de paiement préautorisé ne figure actuellement à votre compte." ]
        },
        "languageCode": "fr-ca"
      } ]
    },
    "targetPage": "_PAP 9 Propose PAP Setup",
    "name": "75896f6a-e243-4ad1-afd1-3d47dfa99efa"
  } ]
}
