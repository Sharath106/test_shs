{
  "name": "5bcce60b-d69a-4d45-94cc-2ba8a568e347",
  "displayName": "AskPIN_Optional",
  "form": {
    "parameters": [ {
      "displayName": "pin",
      "required": true,
      "entityType": "@pin",
      "fillBehavior": {
        "initialPromptFulfillment": {
        
        },
        "repromptEventHandlers": [ {
          "event": "sys.no-match-1",
          "triggerFulfillment": {
            "messages": [ {
              "text": {
                "text": [ "Sorry, Please enter or say your 4 to 6 digit security pin to verify your account." ]
              },
              "languageCode": "en"
            }, {
              "text": {
                "text": [ "Désolé, Veuillez entrer votre code NIP de 4 à 6 chiffres pour vérifier votre compte." ]
              },
              "languageCode": "fr-ca"
            } ],
            "setParameterActions": [ {
              "parameter": "askpin_retrycnt",
              "value": "$sys.func.ADD($session.params.askpin_retrycnt,1)"
            }, {
              "parameter": "pin",
              "value": null
            } ]
          },
          "name": "be524a7f-618c-4f16-b053-a30c70d8d1dc"
        }, {
          "event": "sys.no-match-2",
          "triggerFulfillment": {
            "messages": [ {
              "text": {
                "text": [ "You can either say or enter your security pin to verify your account." ]
              },
              "languageCode": "en"
            }, {
              "text": {
                "text": [ "Vous pouvez entrer votre code NIP pour vérifier votre compte." ]
              },
              "languageCode": "fr-ca"
            } ],
            "setParameterActions": [ {
              "parameter": "askpin_retrycnt",
              "value": "$sys.func.ADD($session.params.askpin_retrycnt,1)"
            }, {
              "parameter": "pin",
              "value": null
            } ]
          },
          "name": "71ac29bb-f000-4f56-af29-cbb15aae7bf3"
        }, {
          "targetFlow": "Default Start Flow",
          "event": "sys.no-match-default",
          "triggerFulfillment": {
            "messages": [ {
              "text": {
                "text": [ "Sorry, I am not sure I understand, how can I help you today ?" ]
              },
              "languageCode": "en"
            }, {
              "text": {
                "text": [ "Désolé, je ne comprends pas. Comment puis-je vous aider aujourd'hui ?" ]
              },
              "languageCode": "fr-ca"
            } ]
          },
          "name": "331a6c5e-49c7-4e37-8468-a4ff3d928b62"
        }, {
          "event": "sys.no-input-1",
          "triggerFulfillment": {
            "messages": [ {
              "text": {
                "text": [ "Sorry, Please enter or say your 4 to 6 digit security pin to verify your account." ]
              },
              "languageCode": "en"
            }, {
              "text": {
                "text": [ "Désolé, Veuillez entrer votre code NIP de 4 à 6 chiffres pour vérifier votre compte. " ]
              },
              "languageCode": "fr-ca"
            } ],
            "setParameterActions": [ {
              "parameter": "askpin_retrycnt",
              "value": "$sys.func.ADD($session.params.askpin_retrycnt,1)"
            }, {
              "parameter": "pin",
              "value": null
            } ]
          },
          "name": "f97fcc9d-21cd-474f-8721-fa6b8335d8da"
        }, {
          "event": "sys.no-input-2",
          "triggerFulfillment": {
            "messages": [ {
              "text": {
                "text": [ "You can either say or enter your security pin to verify your account." ]
              },
              "languageCode": "en"
            }, {
              "text": {
                "text": [ "Vous pouvez entrer votre code NIP pour vérifier votre compte." ]
              },
              "languageCode": "fr-ca"
            } ],
            "setParameterActions": [ {
              "parameter": "askpin_retrycnt",
              "value": "$sys.func.ADD($session.params.askpin_retrycnt,1)"
            }, {
              "parameter": "pin",
              "value": null
            } ]
          },
          "name": "086f0500-134a-49bd-bab2-e31952ba04c7"
        }, {
          "targetFlow": "Default Start Flow",
          "event": "sys.no-input-default",
          "triggerFulfillment": {
            "messages": [ {
              "text": {
                "text": [ "Sorry, I am not sure I understand, how can I help you today ?" ]
              },
              "languageCode": "en"
            }, {
              "text": {
                "text": [ "Désolé, je ne comprends pas . Comment puis-je vous aider aujourd'hui ?" ]
              },
              "languageCode": "fr-ca"
            } ]
          },
          "name": "cd4c9f87-4d6e-4763-96d2-f465ed970a86"
        } ]
      },
      "redact": true
    } ]
  },
  "entryFulfillment": {
    "setParameterActions": [ {
      "parameter": "last_page_temp",
      "value": "AskPIN_Optional"
    } ],
    "conditionalCases": [ {
      "cases": [ {
        "condition": "$session.params.askpin_retrycnt = null AND $session.params.pin = null",
        "caseContent": [ {
          "message": {
            "text": {
              "text": [ "To ensure we provide you with the right support and in order to save time, Please say or enter your 4 to 6 digit security PIN." ]
            },
            "languageCode": "en"
          }
        }, {
          "message": {
            "text": {
              "text": [ "Afin d'accéder à votre compte, veuillez entrer votre code NIP de 4 à 6 chiffres." ]
            },
            "languageCode": "fr-ca"
          }
        } ]
      }, {
        "condition": "$session.params.askpin_retrycnt = 0",
        "caseContent": [ {
          "message": {
            "text": {
              "text": [ "Please enter or say your 4 to 6 digit security pin to verify your account." ]
            },
            "languageCode": "en"
          }
        }, {
          "message": {
            "text": {
              "text": [ "Veuillez entrer votre code NIP de 4 à 6 chiffres." ]
            },
            "languageCode": "fr-ca"
          }
        } ]
      }, {
        "condition": "$session.params.askpin_retrycnt = 1",
        "caseContent": [ {
          "message": {
            "text": {
              "text": [ "Please enter or say your 4 to 6 digit security pin to verify your account." ]
            },
            "languageCode": "en"
          }
        }, {
          "message": {
            "text": {
              "text": [ "Veuillez entrer votre code NIP de 4 à 6 chiffres." ]
            },
            "languageCode": "fr-ca"
          }
        } ]
      }, {
        "condition": "$session.params.askpin_retrycnt = 2",
        "caseContent": [ {
          "message": {
            "text": {
              "text": [ "You can either say or enter your security pin to verify your account." ]
            },
            "languageCode": "en"
          }
        }, {
          "message": {
            "text": {
              "text": [ "Veuillez entrer votre code NIP de 4 à 6 chiffres." ]
            },
            "languageCode": "fr-ca"
          }
        } ]
      }, {
        "condition": "$session.params.pin_retrycnt = 1 OR $session.params.pin_retrycnt = 2",
        "caseContent": [ {
          "message": {
            "text": {
              "text": [ "Please enter or say your 4 to 6 digit security pin." ]
            },
            "languageCode": "en"
          }
        }, {
          "message": {
            "text": {
              "text": [ "Veuillez entrer votre code NIP de 4 à 6 chiffres." ]
            },
            "languageCode": "fr-ca"
          }
        } ]
      } ]
    } ]
  },
  "transitionRoutes": [ {
    "intent": "head_intent.password",
    "condition": "$session.params.targetAccount.isCollection = \"true\"",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "last_page",
        "value": "Ask PIN"
      } ]
    },
    "targetFlow": "Universal handoff",
    "name": "00da54cd-e31e-480a-8869-54cfec2af2ea"
  }, {
    "intent": "head_intent.live_agent_hand_off",
    "condition": "$session.params.async_intent_list : $session.params.last_page AND $session.params.conversation.language = \"en-US\"",
    "triggerFulfillment": {
    
    },
    "targetFlow": "Universal handoff",
    "name": "879d5af1-6e70-47c7-a6a2-b011a645c5e9"
  }, {
    "intent": "head_intent.password",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "route",
        "value": "forgot_PIN"
      } ]
    },
    "targetFlow": "Account Management",
    "name": "bfdb6a5e-e39a-43a8-8134-da31b7280400"
  }, {
    "intent": "supplemental.do_not_have_pin",
    "condition": "$session.params.targetAccount.isCollection = \"true\"",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "coll_pin_declined",
        "value": "true"
      } ]
    },
    "targetFlow": "Collections",
    "name": "60869af0-9445-47d5-90af-461468836950"
  }, {
    "intent": "supplemental.do_not_have_pin",
    "condition": "$session.params.route = \"bib\"",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "auth_dontknow",
        "value": true
      } ]
    },
    "targetFlow": "Activations \u0026 Renewals",
    "name": "ef55f98d-8699-455a-9560-f0ca2761c617"
  }, {
    "intent": "small_talk.confirmation_no",
    "condition": "$session.params.route = \"bib\"",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "auth_dontknow",
        "value": true
      } ]
    },
    "targetFlow": "Activations \u0026 Renewals",
    "name": "d2f7587e-c743-4289-8c19-bae6a31dc910"
  }, {
    "intent": "small_talk.i_dont_know",
    "condition": "$session.params.route = \"bib\"",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "auth_dontknow",
        "value": true
      } ]
    },
    "targetFlow": "Activations \u0026 Renewals",
    "name": "88bed515-4207-4941-9d93-9182dfbc6729"
  }, {
    "intent": "small_talk.confirmation_no",
    "condition": "$session.params.route = \"BIB_Amount\"",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "auth_dontknow",
        "value": true
      } ]
    },
    "targetFlow": "Activations \u0026 Renewals",
    "name": "66e4ae39-1f3e-4e37-a621-2562d420f901"
  }, {
    "intent": "small_talk.i_dont_know",
    "condition": "$session.params.route = \"BIB_Amount\"",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "auth_dontknow",
        "value": true
      } ]
    },
    "targetFlow": "Activations \u0026 Renewals",
    "name": "d5d7be2e-5b69-4e27-9daf-b641193d18e4"
  }, {
    "intent": "supplemental.give_some_time",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "\u003cspeak\u003eSure, no problem.\u003cbreak time=\"58s\"/\u003eAre you still there?\u003c/speak\u003e" ]
        },
        "languageCode": "en"
      }, {
        "text": {
          "text": [ "\u003cspeak\u003eCertainement, pas de problème.\u003cbreak time=\"58s\"/\u003eÊtes-vous toujours là?\u003c/speak\u003e" ]
        },
        "languageCode": "fr-ca"
      } ]
    },
    "name": "0f9a92f1-3fea-42f1-b9de-a29a5805fd44"
  }, {
    "intent": "supplemental.ready_for_pin",
    "triggerFulfillment": {
      "conditionalCases": [ {
        "cases": [ {
          "condition": "$session.params.pin = null",
          "caseContent": [ {
            "message": {
              "text": {
                "text": [ "Great. What is your 4 to 6 digits security pin?" ]
              },
              "languageCode": "en"
            }
          }, {
            "message": {
              "text": {
                "text": [ "Super. Quel est votre nip de sécurité de 4 à 6 chiffres?" ]
              },
              "languageCode": "fr-ca"
            }
          } ]
        } ]
      } ]
    },
    "name": "f1e30d70-8908-4241-b6cb-1c7046754022"
  }, {
    "intent": "head_intent.live_agent_hand_off",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "Okay, let me get someone to help you." ]
        },
        "languageCode": "en"
      }, {
        "text": {
          "text": [ "D'accord, laissez-moi chercher quelqu'un pour vous aider." ]
        },
        "languageCode": "fr-ca"
      } ]
    },
    "targetFlow": "Universal handoff",
    "name": "a1348d29-71cb-4824-987c-10ad7dd39bea"
  }, {
    "intent": "small_talk.confirmation_no",
    "condition": "$session.params.route = \"bill_vague\"",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "unauth",
        "value": true
      }, {
        "parameter": "bill_informational",
        "value": true
      } ]
    },
    "targetFlow": "Bill Vague",
    "name": "4f456ac4-f754-4efd-a8d1-a0b7e15e85af"
  }, {
    "intent": "small_talk.i_dont_know",
    "condition": "$session.params.route = \"bill_vague\"",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "unauth",
        "value": true
      }, {
        "parameter": "route",
        "value": "forgot_PIN"
      } ]
    },
    "targetFlow": "Account Management",
    "name": "3ff2f214-4ec3-435a-a84c-cf9708ed792f"
  }, {
    "intent": "supplemental.do_not_have_pin",
    "condition": "$session.params.route = \"bill_vague\"",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "Don't have your PIN with you or" ]
        },
        "languageCode": "en"
      }, {
        "text": {
          "text": [ "Vous n'avez pas votre code PIN sur vous ou?" ]
        },
        "languageCode": "fr-ca"
      } ],
      "setParameterActions": [ {
        "parameter": "unauth",
        "value": true
      }, {
        "parameter": "route",
        "value": "forgot_PIN"
      } ]
    },
    "targetFlow": "Account Management",
    "name": "48904007-c520-461d-a5e9-4e174d308b0c"
  }, {
    "condition": "$session.params.pin : \"#\"",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "pin",
        "value": "$sys.func.SUBSTITUTE($session.params.pin, \"#\", \"\")"
      } ]
    },
    "name": "dc0322d7-2b8c-4498-8163-bfb90bfbf6d6"
  }, {
    "condition": "$session.params.pin_retrycnt = null",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "pin_retrycnt",
        "value": 0
      } ]
    },
    "name": "c85f4162-b82d-44df-9985-a2f0c49354a6"
  }, {
    "condition": "$session.params.pin != null AND (($sys.func.LEN($sys.func.TO_TEXT($session.params.pin)) \u003e 6 OR $sys.func.LEN($sys.func.TO_TEXT($session.params.pin)) \u003c 4) OR $sys.func.TO_NUMBER($session.params.pin) != $session.params.pin)",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "This doesn't look like a valid security pin. Please say, or key in your 4 to 6 digit security pin." ]
        },
        "languageCode": "en"
      }, {
        "text": {
          "text": [ "Ça ne semble pas être un nip de sécurité valide. Veuillez entrer votre nip de 4 à 6 chiffres." ]
        },
        "languageCode": "fr-ca"
      } ]
    },
    "name": "7f0e6ae3-05ce-45ef-bde5-c7ee6806bde6"
  }, {
    "condition": "$session.params.pin != null",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "Please wait while I verify your pin." ]
        },
        "languageCode": "en"
      }, {
        "text": {
          "text": [ "Veuillez patienter pendant que je vérifie votre code NIP." ]
        },
        "languageCode": "fr-ca"
      } ]
    },
    "targetPage": "PIN Verification",
    "name": "66164cd1-17fc-45d8-be15-19109f33262f"
  }, {
    "condition": "$session.params.pin_retrycnt = 3 AND $session.params.targetAccount.isCollection = \"true\"",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "Let me get you to a team member for more assistance." ]
        },
        "languageCode": "en"
      }, {
        "text": {
          "text": [ "Laissez-moi chercher quelqu'un pour vous aider." ]
        },
        "languageCode": "fr-ca"
      } ],
      "setParameterActions": [ {
        "parameter": "pin_verification",
        "value": "blocked"
      }, {
        "parameter": "last_page",
        "value": "Ask PIN"
      } ]
    },
    "targetFlow": "Universal handoff",
    "name": "8f21f91d-6664-46a6-aa1d-26461e45b98b"
  }, {
    "condition": "$session.params.pin_retrycnt = 3",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "pin_verification",
        "value": "blocked"
      } ]
    },
    "targetPage": "PIN Blocked",
    "name": "60676dd2-0cf7-4849-9cfb-f0d272aec06d"
  }, {
    "condition": "$session.params.askpin_retrycnt = null",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "askpin_retrycnt",
        "value": 0
      } ]
    },
    "name": "ec38918d-ddbf-457d-973c-fe7d14dd97f8"
  }, {
    "condition": "$session.params.askpin_retrycnt \u003e 2",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "askpin_retrycnt",
        "value": null
      } ]
    },
    "targetPage": "No Match 2",
    "name": "a24fcf95-bbf0-462b-9614-fe31f7a4a997"
  } ]
}
