{
  "name": "89a92fca-f394-40dd-868c-8cc732c3ff86",
  "displayName": "SMS Phone Number Collection",
  "form": {
    "parameters": [ {
      "displayName": "sms_phone_number",
      "required": true,
      "entityType": "@sys.phone-number",
      "fillBehavior": {
        "initialPromptFulfillment": {
        
        },
        "repromptEventHandlers": [ {
          "event": "sys.no-match-1",
          "triggerFulfillment": {
            "messages": [ {
              "text": {
                "text": [ "Sorry," ]
              },
              "languageCode": "en"
            }, {
              "text": {
                "text": [ "Please say, or key in the 10 digit Canadian mobile number you want to send the details to." ]
              },
              "languageCode": "en"
            }, {
              "text": {
                "text": [ "Désolé, " ]
              },
              "languageCode": "fr-ca"
            }, {
              "text": {
                "text": [ "Veuillez dire ou entrer le numéro de téléphone mobile canadien à 10 chiffres auquel vous aimeriez envoyer les détails." ]
              },
              "languageCode": "fr-ca"
            } ]
          },
          "name": "da69a17f-a2e7-4a05-ae53-836c18dce34d"
        }, {
          "event": "sys.no-match-2",
          "triggerFulfillment": {
            "messages": [ {
              "text": {
                "text": [ "With your dial pad, enter the 10 digit canadian mobile number to receive a text." ]
              },
              "languageCode": "en"
            }, {
              "text": {
                "text": [ "À l'aide de votre clavier, entrez le numéro de téléphone mobile canadien à 10 chiffres pour recevoir un message texte." ]
              },
              "languageCode": "fr-ca"
            } ]
          },
          "name": "0754c9fc-fea2-4b34-95de-9c213a76fd8e"
        }, {
          "targetPage": "Api Error Agent request",
          "event": "sys.no-match-3",
          "triggerFulfillment": {
            "messages": [ {
              "text": {
                "text": [ "Sorry, I am having issues understanding. " ]
              },
              "languageCode": "en"
            }, {
              "text": {
                "text": [ "I will need to get you to someone to help." ]
              },
              "languageCode": "en"
            }, {
              "text": {
                "text": [ "Désolé, j'ai des problèmes à comprendre." ]
              },
              "languageCode": "fr-ca"
            }, {
              "text": {
                "text": [ "Je vais devoir vous amener à quelqu'un pour vous aider." ]
              },
              "languageCode": "fr-ca"
            } ]
          },
          "name": "1dc20953-099b-4af8-a1c8-5999b80b134d"
        }, {
          "event": "sys.no-input-1",
          "triggerFulfillment": {
            "messages": [ {
              "text": {
                "text": [ "Sorry," ]
              },
              "languageCode": "en"
            }, {
              "text": {
                "text": [ "Please say, or key in the 10 digit Canadian mobile number you want to send the details to." ]
              },
              "languageCode": "en"
            }, {
              "text": {
                "text": [ "Désolé," ]
              },
              "languageCode": "fr-ca"
            }, {
              "text": {
                "text": [ "Veuillez dire ou entrer le numéro de téléphone mobile canadien à 10 chiffres auquel vous aimeriez envoyer les détails." ]
              },
              "languageCode": "fr-ca"
            } ]
          },
          "name": "18f45c5f-28f4-439f-b5af-3bca18ac86ea"
        }, {
          "event": "sys.no-input-2",
          "triggerFulfillment": {
            "messages": [ {
              "text": {
                "text": [ "With your dial pad, enter the 10 digit canadian mobile number to receive a text." ]
              },
              "languageCode": "en"
            }, {
              "text": {
                "text": [ " À l'aide de votre clavier, entrez le numéro de téléphone mobile canadien à 10 chiffres pour recevoir un message texte." ]
              },
              "languageCode": "fr-ca"
            } ]
          },
          "name": "103271cc-2bb7-42de-9d6c-7ec02b8bf075"
        }, {
          "targetPage": "Api Error Agent request",
          "event": "sys.no-input-3",
          "triggerFulfillment": {
          
          },
          "name": "3ad03c2f-190b-47e4-9f08-f7e9150fb84d"
        } ]
      },
      "advancedSettings": {
        "dtmfSettings": {
          "enabled": true,
          "maxDigits": 10,
          "useSystemEntityRule": false,
          "endpointingTimeoutDuration": {
            "seconds": 8
          }
        }
      }
    } ]
  },
  "entryFulfillment": {
    "setParameterActions": [ {
      "parameter": "last_page_temp",
      "value": "SMS Phone Number Collection"
    } ],
    "conditionalCases": [ {
      "cases": [ {
        "condition": "$session.params.phonenum_retrycnt = null OR $session.params.phonenum_retrycnt = 0",
        "caseContent": [ {
          "message": {
            "text": {
              "text": [ "Please say, or key in the 10 digit canadian mobile number you want to send the details to." ]
            },
            "languageCode": "en"
          }
        }, {
          "message": {
            "text": {
              "text": [ "Veuillez entrer à l'aide de votre clavier le numéro de téléphone mobile canadien à 10 chiffres auquel vous souhaitez envoyer les détails." ]
            },
            "languageCode": "fr-ca"
          }
        } ]
      }, {
        "condition": "$session.params.phonenum_retrycnt = 1",
        "caseContent": [ {
          "message": {
            "text": {
              "text": [ "Please say, or key in the 10 digit canadian mobile number you want to send the details to." ]
            },
            "languageCode": "en"
          }
        }, {
          "message": {
            "text": {
              "text": [ "Veuillez entrer à l'aide de votre clavier le numéro de téléphone mobile canadien à 10 chiffres auquel vous souhaitez envoyer les détails." ]
            },
            "languageCode": "fr-ca"
          }
        } ]
      }, {
        "condition": "$session.params.phonenum_retrycnt = 2",
        "caseContent": [ {
          "message": {
            "text": {
              "text": [ "With your dial pad, enter the 10 digit canadian mobile number to receive a text." ]
            },
            "languageCode": "en"
          }
        }, {
          "message": {
            "text": {
              "text": [ "À l'aide de votre clavier, entrez le numéro de téléphone mobile canadien à 10 chiffres pour recevoir un message texte." ]
            },
            "languageCode": "fr-ca"
          }
        } ]
      } ]
    } ]
  },
  "transitionRoutes": [ {
    "intent": "head_intent.live_agent_hand_off",
    "condition": "$session.params.async_intent = true",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "sms_phone_number",
        "value": null
      } ]
    },
    "targetFlow": "Universal handoff",
    "name": "2804db68-569c-4dfb-a7b2-853cb2c99230"
  }, {
    "intent": "small_talk.nevermind",
    "triggerFulfillment": {
    
    },
    "targetPage": "End page",
    "name": "8e76efec-5792-4885-b23c-31f9e38d7869"
  }, {
    "intent": "small_talk.confirmation_no",
    "condition": "$session.params.sms_phone_number = null",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "No problem." ]
        },
        "languageCode": "en"
      }, {
        "text": {
          "text": [ "Aucun problème." ]
        },
        "languageCode": "fr-ca"
      } ]
    },
    "targetPage": "Route back",
    "name": "1b312fac-fda5-42e0-bdab-306865965103"
  }, {
    "condition": "$session.params.sms_phone_number = \"0\"",
    "triggerFulfillment": {
    
    },
    "targetPage": "Api Error Agent request",
    "name": "ed8613dd-5055-465e-ad91-430f892c4353"
  }, {
    "condition": "$session.params.sms_phone_number != null AND $sys.func.LEN($session.params.sms_phone_number) \u003c 10",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "This doesn't sound right. Please say, or key in the full 10 digits of your phone number, including the regional code." ]
        },
        "languageCode": "en"
      }, {
        "text": {
          "text": [ "Veuillez dire ou saisir les 10 chiffres complets de votre numéro de téléphone, y compris le code régional." ]
        },
        "languageCode": "fr-ca"
      } ],
      "setParameterActions": [ {
        "parameter": "sms_phone_number",
        "value": null
      } ]
    },
    "name": "a9584b3b-a81e-478c-8f0d-89825e6ebdb6"
  }, {
    "condition": "$session.params.sms_phone_number != null AND $session.params.confirm_num = null",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "confirm_num",
        "value": "1"
      } ]
    },
    "targetPage": "SMS Phone Number Collection \u003e Confirm number entry",
    "name": "941e4a36-62ce-400e-ac72-f833ba9f46aa"
  }, {
    "condition": "$session.params.sms_phone_number != null AND $session.params.confirm_num = \"2\"",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "confirm_num",
        "value": "3"
      } ]
    },
    "targetPage": "SMS Phone Number Collection \u003e Confirm number entry",
    "name": "37781c4d-712c-4d93-a64d-42a3816e092f"
  }, {
    "condition": "$session.params.phonenum_retrycnt = null",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "phonenum_retrycnt",
        "value": 0
      } ]
    },
    "name": "3440a5c2-9e99-42ad-a3c8-00c7870565f6"
  }, {
    "condition": "$session.params.phonenum_retrycnt \u003e 2",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "Sorry, I am having issues understanding. " ]
        },
        "languageCode": "en"
      }, {
        "text": {
          "text": [ "I will need to get you to a team member for further support." ]
        },
        "languageCode": "en"
      }, {
        "text": {
          "text": [ "Désolé, je n'ai pas compris." ]
        },
        "languageCode": "fr-ca"
      }, {
        "text": {
          "text": [ "Je vais devoir vous mettre en contact avec quelqu'un qui pourra vous aider." ]
        },
        "languageCode": "fr-ca"
      } ]
    },
    "targetPage": "Api Error Agent request",
    "name": "e0f5d59a-961d-4e76-8086-d4351fdd1dca"
  } ],
  "eventHandlers": [ {
    "targetPage": "Current Page",
    "event": "NO_INPUT",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "phonenum_retrycnt",
        "value": "$sys.func.ADD($session.params.phonenum_retrycnt,1)"
      } ],
      "conditionalCases": [ {
        "cases": [ {
          "condition": "$session.params.phonenum_retrycnt = 0",
          "caseContent": [ {
            "message": {
              "text": {
                "text": [ "Sorry, I didn't quite get that." ]
              },
              "languageCode": "en"
            }
          }, {
            "message": {
              "text": {
                "text": [ "Désolé, je ne crois pas avoir bien saisi." ]
              },
              "languageCode": "fr-ca"
            }
          } ]
        }, {
          "condition": "$session.params.phonenum_retrycnt = 1",
          "caseContent": [ {
            "message": {
              "text": {
                "text": [ "Sorry, I didn't catch that." ]
              },
              "languageCode": "en"
            }
          }, {
            "message": {
              "text": {
                "text": [ "Désolé, je n'ai pas tout à fait compris." ]
              },
              "languageCode": "fr-ca"
            }
          } ]
        } ]
      } ]
    },
    "name": "cbbd6561-3abf-4102-9031-c14e2a44dbb9"
  } ]
}
