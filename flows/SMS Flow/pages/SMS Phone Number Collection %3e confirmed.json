{
  "name": "2642b68c-20f1-41e2-a3de-625dfb699b2b",
  "displayName": "SMS Phone Number Collection \u003e confirmed",
  "form": {
  
  },
  "entryFulfillment": {
    "webhook": "Account Identity VC",
    "tag": "verify_tn",
    "setParameterActions": [ {
      "parameter": "lookupType",
      "value": "tn"
    }, {
      "parameter": "lookupNumber",
      "value": "$session.params.sms_phone_number"
    }, {
      "parameter": "entryBrand",
      "value": "$session.params.routeDetails.brand"
    }, {
      "parameter": "environment",
      "value": "it04"
    } ]
  },
  "transitionRoutes": [ {
    "condition": "$session.params.sms_phone_number = \"4848741495\" OR $session.params.sms_phone_number = \"7247032163\"",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "isCanadianTn",
        "value": "true"
      } ]
    },
    "name": "0d22ddfc-4407-40ea-af2b-070fe9352e5b"
  }, {
    "condition": "$session.params.error_code != null AND $session.params.api_delay = \"false\" AND $session.params.error_retry != \"1\"",
    "triggerFulfillment": {
      "webhook": "Account Identity VC",
      "tag": "verify_tn",
      "setParameterActions": [ {
        "parameter": "error_code",
        "value": null
      }, {
        "parameter": "error_retry",
        "value": "1"
      }, {
        "parameter": "api_delay",
        "value": null
      }, {
        "parameter": "error_full_response",
        "value": null
      }, {
        "parameter": "error_api_name",
        "value": null
      } ]
    },
    "name": "f0cec95c-b13c-49c3-93aa-6f2472b60714"
  }, {
    "condition": "($session.params.error_code != null AND $session.params.error_retry = \"1\") OR ($session.params.api_delay = \"true\" AND $session.params.error_code != null)",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "Sorry, I am having issues with sending the text." ]
        },
        "languageCode": "en"
      }, {
        "text": {
          "text": [ "Let me get you to a team member for more help.", "I will need to get you to someone who can help." ]
        },
        "languageCode": "en"
      }, {
        "text": {
          "text": [ "Désolé, j'ai des problèmes avec l'envoi du message texte." ]
        },
        "languageCode": "fr-ca"
      }, {
        "text": {
          "text": [ "Je vais devoir vous amener à un membre de l'équipe.", "Je vais devoir vous mettre en contact avec quelqu'un qui pourra vous aider." ]
        },
        "languageCode": "fr-ca"
      } ],
      "setParameterActions": [ {
        "parameter": "error_retry",
        "value": null
      }, {
        "parameter": "error_code",
        "value": null
      }, {
        "parameter": "api_delay",
        "value": null
      }, {
        "parameter": "error_full_response",
        "value": null
      }, {
        "parameter": "error_api_name",
        "value": null
      }, {
        "parameter": "sms_phone_number",
        "value": null
      } ]
    },
    "targetPage": "Api Error Agent request",
    "name": "21d4fe95-ef13-417f-b3a6-a46bab9d9151"
  }, {
    "condition": "$session.params.isCanadianTn = \"false\"",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "Sorry, at this time we can only send text to Canadian numbers." ]
        },
        "languageCode": "en"
      }, {
        "text": {
          "text": [ "Désolé, pour le moment, nous ne pouvons envoyer de message texte qu'aux numéros canadiens." ]
        },
        "languageCode": "fr-ca"
      } ]
    },
    "targetPage": "SMS Phone number Non Canadian",
    "name": "219a7fea-d09a-419c-94ce-821666709027"
  }, {
    "condition": "$session.params.serviceType = \"WIRELINE\"",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "We are not able to send a text message to a home phone number." ]
        },
        "languageCode": "en"
      }, {
        "text": {
          "text": [ "Nous ne sommes pas en mesure d'envoyer de message texte à un numéro de téléphone résidentiel. " ]
        },
        "languageCode": "fr-ca"
      } ],
      "setParameterActions": [ {
        "parameter": "sms_phone_number",
        "value": null
      } ]
    },
    "targetPage": "SMS Phone Number Collection",
    "name": "c329bd42-67f8-4952-83d9-d60d8028f0fe"
  }, {
    "condition": "$session.params.isTelusTn = \"false\" AND $session.params.isCanadianTn = \"true\"",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "mobileCarrierIsTelus",
        "value": "n"
      }, {
        "parameter": "new_number_enter",
        "value": "true"
      }, {
        "parameter": "shortCode",
        "value": "53811"
      } ]
    },
    "targetPage": "SMS Link",
    "name": "7e2329f1-e2d3-4351-bd11-e1fa4bdabe66"
  }, {
    "condition": "$session.params.isTelusTn = \"true\" AND $session.params.isCanadianTn = \"true\"",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "mobileCarrierIsTelus",
        "value": "y"
      }, {
        "parameter": "new_number_enter",
        "value": "true"
      }, {
        "parameter": "shortCode",
        "value": "5420"
      } ]
    },
    "targetPage": "SMS Link",
    "name": "a86956ec-ab4d-4971-85ad-782850999e56"
  } ],
  "eventHandlers": [ {
    "targetPage": "Api Error Agent request",
    "event": "webhook.error",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "Sorry, I'm not able to send you a text at this time.", "I wasn't able to send you the text.", "The text I sent isn't going through." ]
        },
        "languageCode": "en"
      }, {
        "text": {
          "text": [ "I will need to get you to a team member.", "I will need to get you to someone who can help." ]
        },
        "languageCode": "en"
      } ]
    },
    "name": "742d2639-0079-411f-be63-9bfee88a4a52"
  }, {
    "targetPage": "Api Error Agent request",
    "event": "webhook.error.timeout",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "Sorry, I'm not able to send you a text at this time.", "The text I sent isn't going through.", " I wasn't able to send you the text." ]
        },
        "languageCode": "en"
      }, {
        "text": {
          "text": [ "I will need to get you to someone who can help.", "I will need to get you to a team member." ]
        },
        "languageCode": "en"
      } ]
    },
    "name": "36cb678e-398f-4f8d-ba00-ee466474928c"
  } ]
}
