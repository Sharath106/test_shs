{
  "name": "266eea78-5fba-4a15-a8fd-f41daacbb564",
  "displayName": "Payment Overdue",
  "form": {
    "parameters": [ {
      "displayName": "dtmf_payment_overdue",
      "required": true,
      "entityType": "@dtmf-menu",
      "fillBehavior": {
        "initialPromptFulfillment": {
        
        },
        "repromptEventHandlers": [ {
          "event": "sys.no-match-1",
          "triggerFulfillment": {
            "messages": [ {
              "text": {
                "text": [ "Je ne pense pas avoir compris.", "Je n'ai pas vraiment compris.", "Je ne crois pas avoir compris." ]
              },
              "languageCode": "fr-ca"
            }, {
              "text": {
                "text": [ "Pouvez-vous reformuler votre phrase, s'il vous plaît?", "Pouvez-vous essayer de reformuler votre question?", "Pouvez-vous reformuler votre phrase pour moi?" ]
              },
              "languageCode": "fr-ca"
            }, {
              "text": {
                "text": [ "I'm not sure I got this one.", "I didn't really catch that.", "I'm not sure I understand." ]
              },
              "languageCode": "en"
            }, {
              "text": {
                "text": [ "Do you mind rephrasing?", "Can you try to rephrase your question? ", "Can you reword that for me?" ]
              },
              "languageCode": "en"
            } ]
          },
          "name": "556fc4d9-788b-49a8-bc34-98fc0072d1bb"
        }, {
          "event": "sys.no-match-2",
          "triggerFulfillment": {
            "messages": [ {
              "text": {
                "text": [ "Je ne crois toujours pas avoir compris.", "Je ne comprends toujours pas bien." ]
              },
              "languageCode": "fr-ca"
            }, {
              "text": {
                "text": [ "Vous pouvez dire ou appuyer sur 1 pour oui, ou sur 2 pour non." ]
              },
              "languageCode": "fr-ca"
            }, {
              "text": {
                "text": [ "I'm still not sure I got this.", "I still don't quite understand." ]
              },
              "languageCode": "en"
            }, {
              "text": {
                "text": [ "You can type 1 for Yes and 2 for No on your dial pad." ]
              },
              "languageCode": "en"
            } ]
          },
          "name": "4a1ddf5c-9d5c-4cd4-9a5d-0ebe7c2a7da1"
        }, {
          "targetPage": "No Match 2",
          "event": "sys.no-match-3",
          "triggerFulfillment": {
          
          },
          "name": "9729314c-bd3c-40b4-bce0-bda6a56a1c8d"
        }, {
          "event": "sys.no-input-1",
          "triggerFulfillment": {
            "messages": [ {
              "text": {
                "text": [ "Désolé, je n'ai pas bien compris." ]
              },
              "languageCode": "fr-ca"
            }, {
              "text": {
                "text": [ "Sorry, I didn't quite get that." ]
              },
              "languageCode": "en"
            } ],
            "conditionalCases": [ {
              "cases": [ {
                "condition": "1 = 1",
                "caseContent": [ {
                  "message": {
                    "text": {
                      "text": [ "\u003cspeak\u003eNous n’avons pas reçu votre dernier paiement avant la date limite, donc des frais de retard de       $session.params.other_charges.LatePaymentCharge[1] $ ont été appliqués sur votre facture du $sys.func.FORMAT_DATE($session.params.bill_summary.billSummary.billDt, \"dd MMMM, yyyy\", \"fr-ca\")." ]
                    },
                    "languageCode": "fr-ca"
                  }
                }, {
                  "message": {
                    "text": {
                      "text": [ "\u003cspeak\u003eWe did not receive your last payment before the due date, which resulted in a late payment fee of       $$session.params.other_charges.LatePaymentCharge[1] when the invoice came out on $sys.func.FORMAT_DATE($session.params.bill_summary.billSummary.billDt, \"MMMM dd, yyyy\", \"en\")." ]
                    },
                    "languageCode": "en"
                  }
                } ]
              } ]
            }, {
              "cases": [ {
                "condition": "$session.params.past_due_amt \u003e 0",
                "caseContent": [ {
                  "message": {
                    "text": {
                      "text": [ "Présentement, pour le \u003csay-as interpret-as=\"numéro de téléphone\"\u003e$session.params.phone_number line\u003c/say-as\u003e, un montant de $session.params.past_due_amt $ est dû pour le $sys.func.FORMAT_DATE($session.params.payment_due_date,\"dd MMMM, yyyy\", \"fr-ca\")." ]
                    },
                    "languageCode": "fr-ca"
                  }
                }, {
                  "message": {
                    "text": {
                      "text": [ "Currently, for the \u003csay-as interpret-as=\"telephone\"\u003e$session.params.phone_number line\u003c/say-as\u003e, an             amount of $$session.params.past_due_amt is due by $sys.func.FORMAT_DATE($session.params.payment_due_date,\"MMMM dd, yyyy\", \"en\")." ]
                    },
                    "languageCode": "en"
                  }
                } ]
              } ]
            }, {
              "cases": [ {
                "condition": "1 = 1",
                "caseContent": [ {
                  "message": {
                    "text": {
                      "text": [ "Pour éviter tout retard de paiement à l’avenir, considérez de mettre en place des paiements préautorisés à partir de votre compte bancaire ou de votre carte de crédit." ]
                    },
                    "languageCode": "fr-ca"
                  }
                }, {
                  "message": {
                    "text": {
                      "text": [ "Voulez-vous configurer les paiements préautorisés?\u003c/speak\u003e" ]
                    },
                    "languageCode": "fr-ca"
                  }
                }, {
                  "message": {
                    "text": {
                      "text": [ "To avoid a late payment in the future, consider setting up pre-authorized payments from your bank account or   your credit card." ]
                    },
                    "languageCode": "en"
                  }
                }, {
                  "message": {
                    "text": {
                      "text": [ "Would you like to set up pre-authorized payments?\u003c/speak\u003e" ]
                    },
                    "languageCode": "en"
                  }
                } ]
              } ]
            } ]
          },
          "name": "79359f50-7f54-4fb4-8358-104ddb0665a1"
        }, {
          "event": "sys.no-input-2",
          "triggerFulfillment": {
            "messages": [ {
              "text": {
                "text": [ "Désolé, je n'ai pas compris." ]
              },
              "languageCode": "fr-ca"
            }, {
              "text": {
                "text": [ "Pour mettre en place les paiements préautorisés, appuyez sur le 1, pour dire non, appuyez sur le 2." ]
              },
              "languageCode": "fr-ca"
            }, {
              "text": {
                "text": [ "Sorry, I didn't catch that." ]
              },
              "languageCode": "en"
            }, {
              "text": {
                "text": [ "To set up pre-authorized payments, press 1, to say no, press 2." ]
              },
              "languageCode": "en"
            } ]
          },
          "name": "6d444660-3e88-46de-be1f-b1bffebb0bf3"
        }, {
          "targetPage": "No Match 2",
          "event": "sys.no-input-3",
          "triggerFulfillment": {
          
          },
          "name": "9f08da8c-59e7-4707-8449-eef483aa7537"
        } ]
      },
      "advancedSettings": {
        "dtmfSettings": {
          "enabled": true,
          "maxDigits": 1,
          "useSystemEntityRule": false,
          "endpointingTimeoutDuration": {
            "seconds": 10
          }
        }
      }
    } ]
  },
  "entryFulfillment": {
    "webhook": "Bill explain",
    "tag": "compare_bills",
    "setParameterActions": [ {
      "parameter": "bill_compare_reason",
      "value": "payment overdue"
    }, {
      "parameter": "last_charge_displayed",
      "value": "payment_overdue"
    }, {
      "parameter": "last_page",
      "value": "Payment Overdue"
    } ],
    "conditionalCases": [ {
      "cases": [ {
        "condition": "$session.params.retrycnt_payment_overdue = 2",
        "caseContent": [ {
          "message": {
            "text": {
              "text": [ "Pour configurer les paiements préautorisés, dites ou appuyez sur le 1, sinon dites ou appuyez sur le 2." ]
            },
            "languageCode": "fr-ca"
          }
        }, {
          "message": {
            "text": {
              "text": [ "To set up pre-authorized payments, press 1, to say no, press 2." ]
            },
            "languageCode": "en"
          }
        } ]
      }, {
        "caseContent": [ {
          "additionalCases": {
            "cases": [ {
              "condition": "$session.params.chargeTypeFlag = 1",
              "caseContent": [ {
                "message": {
                  "text": {
                    "text": [ "\u003cspeak\u003eNous n'avons pas reçu votre dernier paiement avant la date d'échéance, ce qui a entraîné des frais de retard de paiement de \u003cprosody rate=\"slow\"\u003e$session.params.currentChargeItem.otherChargeAmt $ \u003c/prosody\u003elorsque la facture a été émise le $sys.func.FORMAT_DATE($session.params.bill_summary.billSummary.billDt, \"dd MMMM YYYY\", \"fr-ca\")." ]
                  },
                  "languageCode": "fr-ca"
                }
              }, {
                "message": {
                  "text": {
                    "text": [ "\u003cspeak\u003eWe did not receive your last payment before the due date, which resulted in a late payment fee of \u003cprosody rate=”slow”\u003e       $$session.params.currentChargeItem.otherChargeAmt \u003c/prosody\u003ewhen the invoice came out on $sys.func.FORMAT_DATE($session.params.bill_summary.billSummary.billDt, \"MMMM dd, yyyy\", \"en\")." ]
                  },
                  "languageCode": "en"
                }
              }, {
                "additionalCases": {
                  "cases": [ {
                    "condition": "$session.params.past_due_amt \u003e 0",
                    "caseContent": [ {
                      "message": {
                        "text": {
                          "text": [ "Actuellement, pour la ligne \u003csay-as perform-as=\"telephone\" google:style=\"zero-as-zero\"\u003e$session.params.phone_number\u003c/say-as\u003e, un montant de $session.params.past_due_amt $ est dû avant le $sys.func.FORMAT_DATE($session.params.payment_due_date,\"dd MMMM YYYY\", \"fr-ca\")." ]
                        },
                        "languageCode": "fr-ca"
                      }
                    }, {
                      "message": {
                        "text": {
                          "text": [ "Currently, for the \u003csay-as interpret-as=\"telephone\" google:style='zero-as-zero'\u003e$session.params.phone_number line\u003c/say-as\u003e, an             amount of $$session.params.past_due_amt is due by $sys.func.FORMAT_DATE ($session.params.payment_due_date,\"MMMM dd, yyyy\", \"en\")." ]
                        },
                        "languageCode": "en"
                      }
                    } ]
                  } ]
                }
              }, {
                "message": {
                  "text": {
                    "text": [ "Pour éviter un retard de paiement dans le futur, pensez à mettre en place des paiements préautorisés à partir de votre compte bancaire ou de votre carte de crédit." ]
                  },
                  "languageCode": "fr-ca"
                }
              }, {
                "message": {
                  "text": {
                    "text": [ "Souhaitez-vous configurer des paiements préautorisés ?\u003c/speak\u003e" ]
                  },
                  "languageCode": "fr-ca"
                }
              }, {
                "message": {
                  "text": {
                    "text": [ "To avoid a late payment in the future, consider setting up pre-authorized payments from your bank account or   your credit card." ]
                  },
                  "languageCode": "en"
                }
              }, {
                "message": {
                  "text": {
                    "text": [ "Would you like to set up pre-authorized payments?\u003c/speak\u003e" ]
                  },
                  "languageCode": "en"
                }
              } ]
            }, {
              "caseContent": [ {
                "message": {
                  "text": {
                    "text": [ "\u003cspeak\u003eNous n'avons pas reçu votre dernier paiement avant la date d'échéance, ce qui a entraîné des frais de retard de \u003cprosody rate=\"slow\"\u003e$session.params.duplicate_charges.previousBill.otherChargeItems.LatePaymentCharge[1] $ \u003c/prosody\u003elorsque la facture est sortie le $sys.func.FORMAT_DATE($session.params.bill_summary.billSummary.billDt, \"dd MMMM YYYY\", \"fr-ca\")." ]
                  },
                  "languageCode": "fr-ca"
                }
              }, {
                "message": {
                  "text": {
                    "text": [ "\u003cspeak\u003eWe did not receive your last payment before the due date, which resulted in a late payment fee of \u003cprosody rate=”slow”\u003e       $$session.params.duplicate_charges.previousBill.otherChargeItems.LatePaymentCharge[1] \u003c/prosody\u003ewhen the invoice came out on $sys.func.FORMAT_DATE($session.params.bill_summary.billSummary.billDt, \"MMMM dd, yyyy\", \"en\")." ]
                  },
                  "languageCode": "en"
                }
              }, {
                "additionalCases": {
                  "cases": [ {
                    "condition": "$session.params.past_due_amt \u003e 0",
                    "caseContent": [ {
                      "message": {
                        "text": {
                          "text": [ "Actuellement, pour la ligne \u003csay-as perform-as=\"telephone\" google:style=\"zero-as-zero\"\u003e$session.params.phone_number\u003c/say-as\u003e, un montant de $session.params.past_due_amt $ est dû avant le $sys.func.FORMAT_DATE($session.params.payment_due_date,\"dd MMMM YYYY\", \"fr-ca\")." ]
                        },
                        "languageCode": "fr-ca"
                      }
                    }, {
                      "message": {
                        "text": {
                          "text": [ "Currently, for the \u003csay-as interpret-as=\"telephone\" google:style='zero-as-zero'\u003e$session.params.phone_number line\u003c/say-as\u003e, an             amount of $$session.params.past_due_amt is due by $sys.func.FORMAT_DATE ($session.params.payment_due_date,\"MMMM dd, yyyy\", \"en\")." ]
                        },
                        "languageCode": "en"
                      }
                    } ]
                  } ]
                }
              }, {
                "message": {
                  "text": {
                    "text": [ "Pour éviter un retard de paiement dans le futur, pensez à mettre en place des paiements préautorisés à partir de votre compte bancaire ou de votre carte de crédit. Souhaitez-vous établir des paiements préautorisés? \u003c/speak\u003e" ]
                  },
                  "languageCode": "fr-ca"
                }
              }, {
                "message": {
                  "text": {
                    "text": [ "To avoid a late payment in the future, consider setting up pre-authorized payments from your bank account or   your credit card." ]
                  },
                  "languageCode": "en"
                }
              }, {
                "message": {
                  "text": {
                    "text": [ "Would you like to set up pre-authorized payments?\u003c/speak\u003e" ]
                  },
                  "languageCode": "en"
                }
              } ]
            } ]
          }
        } ]
      } ]
    } ]
  },
  "transitionRoutes": [ {
    "intent": "small_talk.confirmation_yes",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "route",
        "value": "pre-authorized_payments"
      } ]
    },
    "targetFlow": "Payment",
    "name": "d211309a-0fd3-4b29-8b02-0bfa0ec07192"
  }, {
    "intent": "small_talk.confirmation_no",
    "triggerFulfillment": {
    
    },
    "targetPage": "Is Multiple Charge",
    "name": "d9682330-d008-4a30-8ae3-62e51468ecca"
  }, {
    "intent": "head_intent.payment_arrangements",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "route",
        "value": "payment_arrangement"
      } ]
    },
    "targetFlow": "Payment",
    "name": "1d4ce08f-8e43-4585-8255-8585d2068eab"
  }, {
    "intent": "head_intent.payment_made",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "route",
        "value": "payment_made"
      } ]
    },
    "targetFlow": "Payment",
    "name": "26a9e427-8a8e-4a22-9e12-a194d6f3a835"
  }, {
    "intent": "head_intent.payment_make",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "route",
        "value": "payment_make"
      } ]
    },
    "targetFlow": "Payment",
    "name": "7b8e68f6-b7ec-4adb-8a8e-63e3a7249c02"
  }, {
    "intent": "head_intent.preauthorized_payment_setup",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "route",
        "value": "preauth_payment"
      }, {
        "parameter": "payment_method_action",
        "value": "add"
      } ]
    },
    "targetFlow": "Payment",
    "name": "fa539c83-54e6-447d-bb9e-bf86e4eda291"
  }, {
    "intent": "head_intent.bill_amount_due",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "route",
        "value": "bill_amount_due"
      }, {
        "parameter": "from_flow",
        "value": "bill_explanation"
      }, {
        "parameter": "from_page",
        "value": "payment_overdue"
      } ]
    },
    "targetFlow": "Billing",
    "name": "51075e0f-ed94-4818-8b54-80b51cd49850"
  }, {
    "intent": "small_talk.check_another_line",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "bill_period_select",
        "value": null
      }, {
        "parameter": "bill_period",
        "value": null
      } ]
    },
    "targetPage": "Select Current Bill",
    "name": "cd2ea3ad-bd0c-4d5f-80c7-82aeac304e1f"
  }, {
    "intent": "head_intent.live_agent_hand_off",
    "condition": "$session.params.conversation.language = \"en-US\"",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "Bien sur, il me fera plaisir de vous mettre en contact avec un membre de l’équipe." ]
        },
        "languageCode": "fr-ca"
      } ]
    },
    "targetFlow": "Universal handoff",
    "name": "2d89c479-a197-4477-a21b-ca3a91ef2bc9"
  }, {
    "intent": "head_intent.live_agent_hand_off",
    "condition": "($session.params.agent_attempt = 0 OR $session.params.agent_attempt = 1 OR $session.params.agent_attempt = 2) AND $session.params.conversation.language = \"fr-CA\"",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "agent_attempt",
        "value": "$sys.func.ADD($session.params.agent_attempt, 1)"
      } ],
      "conditionalCases": [ {
        "cases": [ {
          "condition": "$session.params.agent_attempt = 0",
          "caseContent": [ {
            "message": {
              "text": {
                "text": [ "Je comprends votre inquiétude, et je suis là pour vous aider. Étant donné que le temps d'attente pour nos agents peut être plus long que d'habitude, je suis convaincu que je peux vous aider avec votre demande. Souhaitez-vous continuer notre conversation afin que je puisse faire de mon mieux pour vous aider ?" ]
              },
              "languageCode": "fr-ca"
            }
          } ]
        }, {
          "condition": "$session.params.agent_attempt = 1",
          "caseContent": [ {
            "message": {
              "text": {
                "text": [ "Je suis là pour vous aider en toute confiance et avec toutes vos questions concernant votre facturation. Voudriez-vous me donner une autre chance pour vous aider ?" ]
              },
              "languageCode": "fr-ca"
            }
          } ]
        }, {
          "caseContent": [ {
            "message": {
              "text": {
                "text": [ "Afin de vous faire gagner du temps, veuillez m'indiquer en détail vos questions de facturation." ]
              },
              "languageCode": "fr-ca"
            }
          } ]
        } ]
      } ]
    },
    "name": "2047463b-60fb-432d-962f-2203c74d4a6e"
  }, {
    "intent": "head_intent.live_agent_hand_off",
    "condition": "$session.params.agent_attempt = 3 AND $session.params.conversation.language = \"fr-CA\"",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "Bien sure, laissez-moi vous mettre en contacte avec un membre de l'équipe." ]
        },
        "languageCode": "fr-ca"
      } ]
    },
    "targetFlow": "Universal handoff",
    "name": "26069ae3-b4f8-4f71-b15d-028e7cc61a7a"
  }, {
    "condition": "$session.params.retrycnt_payment_overdue = null",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "retrycnt_payment_overdue",
        "value": 0
      } ]
    },
    "name": "902d043c-dd33-4a32-9c3e-24a3b24292b0"
  }, {
    "condition": "$session.params.dtmf_payment_overdue = \"1\"",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "route",
        "value": "pre-authorized_payments"
      } ]
    },
    "targetFlow": "Payment",
    "name": "72c85118-9607-4969-aa50-d00aacd5e0f9"
  }, {
    "condition": "$session.params.dtmf_payment_overdue = \"2\"",
    "triggerFulfillment": {
    
    },
    "targetPage": "Is Multiple Lines",
    "name": "873b5ab1-52d0-481f-84ec-4f37c183a769"
  }, {
    "condition": "$session.params.retrycnt_payment_overdue \u003e 2",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "retrycnt_payment_overdue",
        "value": null
      } ]
    },
    "targetPage": "No Match 2",
    "name": "ce56ad00-1de9-469b-9f22-bada9fa0346a"
  }, {
    "condition": "$session.params.dtmf_payment_overdue = 0 OR $session.params.dtmf_payment_overdue = 3 OR $session.params.dtmf_payment_overdue = 9",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "I'm Sorry, I didn’t understand that.", "Sorry, I didn't catch that.", "I didn't get that." ]
        },
        "languageCode": "en"
      } ],
      "setParameterActions": [ {
        "parameter": "dtmf_payment_overdue",
        "value": null
      }, {
        "parameter": "retrycnt_payment",
        "value": "$sys.func.ADD($session.params.retrycnt_payment,1)"
      } ]
    },
    "targetPage": "Current Page",
    "name": "4c4a29a7-2a11-4f3b-8c77-9e8c50f0d602"
  } ],
  "eventHandlers": [ {
    "targetFlow": "Billing",
    "event": "webhook.error",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "Désolé, j'ai un problème avec votre demande." ]
        },
        "languageCode": "fr-ca"
      }, {
        "text": {
          "text": [ "Sorry, I am having issues with your request." ]
        },
        "languageCode": "en"
      } ],
      "setParameterActions": [ {
        "parameter": "route",
        "value": "bill_explanation"
      } ]
    },
    "name": "66375061-7623-489b-a4da-fbc5173619b3"
  }, {
    "targetPage": "Current Page",
    "event": "NO_INPUT",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "retrycnt_payment_overdue",
        "value": "$sys.func.ADD($session.params.retrycnt_payment_overdue ,1)"
      } ],
      "conditionalCases": [ {
        "cases": [ {
          "condition": "$session.params.retrycnt_payment_overdue = 0",
          "caseContent": [ {
            "message": {
              "text": {
                "text": [ "Désolé, je n'ai pas bien compris." ]
              },
              "languageCode": "fr-ca"
            }
          }, {
            "message": {
              "text": {
                "text": [ "Sorry, I didn't quite get that." ]
              },
              "languageCode": "en"
            }
          } ]
        }, {
          "condition": "$session.params.retrycnt_payment_overdue = 1",
          "caseContent": [ {
            "message": {
              "text": {
                "text": [ "Désolé, je n'ai pas compris." ]
              },
              "languageCode": "fr-ca"
            }
          }, {
            "message": {
              "text": {
                "text": [ "Sorry, I didn't catch that." ]
              },
              "languageCode": "en"
            }
          } ]
        } ]
      } ]
    },
    "name": "5c56a88e-dc3b-4a90-b762-f96551420590"
  }, {
    "targetFlow": "Bill Explanation",
    "event": "webhook.error.timeout",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "Sorry, I am having issues with your request." ]
        },
        "languageCode": "en"
      } ],
      "setParameterActions": [ {
        "parameter": "route",
        "value": "bill_explanation"
      } ]
    },
    "name": "554a2f36-20ec-4f06-bfd2-0a8e148a6015"
  } ],
  "transitionRouteGroups": [ "Payment overdue", "Credit / Waive Fee / Discount", "Bill Balance", "General follow-ups", "Main / All reasons", "Small Talk", "Disambiguation", "AAM Plans Available", "Charges Details" ]
}
