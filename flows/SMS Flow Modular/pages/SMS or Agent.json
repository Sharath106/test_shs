{
  "name": "cca649f5-434f-42f0-ae27-7f185719aaef",
  "displayName": "SMS or Agent",
  "form": {
    "parameters": [ {
      "displayName": "sms_or_agent",
      "required": true,
      "entityType": "@sms_or_agent",
      "fillBehavior": {
        "initialPromptFulfillment": {
          "messages": [ {
            "text": {
              "text": [ "$session.params.offer_script" ]
            },
            "languageCode": "en"
          }, {
            "text": {
              "text": [ "$session.params.offer_script" ]
            },
            "languageCode": "fr-ca"
          } ]
        },
        "repromptEventHandlers": [ {
          "event": "sys.long-utterance",
          "triggerFulfillment": {
          
          },
          "name": "d3d00d0b-7d5c-4cf7-8ed2-9a8d5ec065f0"
        }, {
          "event": "sys.no-input-1",
          "triggerFulfillment": {
            "messages": [ {
              "text": {
                "text": [ "Would you like to receive an SMS, or speak to an agent?" ]
              },
              "languageCode": "en"
            }, {
              "text": {
                "text": [ "Sorry,  I didn't get that." ]
              },
              "languageCode": "en"
            }, {
              "text": {
                "text": [ "Aimeriez-vous que j'envoie un message texte avec plus d'informations?" ]
              },
              "languageCode": "fr-ca"
            }, {
              "text": {
                "text": [ "Désolé, je n'ai pas compris." ]
              },
              "languageCode": "fr-ca"
            } ]
          },
          "name": "95c91b39-5860-4486-b85f-6ffe1e6f3f41"
        }, {
          "event": "sys.no-input-2",
          "triggerFulfillment": {
            "messages": [ {
              "text": {
                "text": [ "To receive an SMS, press 1. To speak to an agent, press 2." ]
              },
              "languageCode": "en"
            }, {
              "text": {
                "text": [ "Sorry,  I didn't get that. " ]
              },
              "languageCode": "en"
            }, {
              "text": {
                "text": [ "Afin de recevoir un SMS appuyez sur le 1. Pour parler a un agent appuyez sur le 2." ]
              },
              "languageCode": "fr-ca"
            }, {
              "text": {
                "text": [ "Désolé, je n'ai pas compris." ]
              },
              "languageCode": "fr-ca"
            } ]
          },
          "name": "65d22823-2ca0-4c7d-ba47-b9845a2ece0f"
        }, {
          "targetPage": "Return To Start",
          "event": "sys.no-input-default",
          "triggerFulfillment": {
            "messages": [ {
              "text": {
                "text": [ "Sorry, I'm still having issues understanding.  Let's start again." ]
              },
              "languageCode": "en"
            }, {
              "text": {
                "text": [ "Désolé, j'ai de la difficulté a vous comprendre, recommençons" ]
              },
              "languageCode": "fr-ca"
            } ],
            "setParameterActions": [ {
              "parameter": "return",
              "value": "Y"
            } ]
          },
          "name": "41887d69-420b-4e79-b76a-22f87d7813d9"
        }, {
          "event": "sys.no-match-1",
          "triggerFulfillment": {
            "messages": [ {
              "text": {
                "text": [ "Would you like to receive an SMS, or speak to an agent?" ]
              },
              "languageCode": "en"
            }, {
              "text": {
                "text": [ "Sorry, I didn't understand that." ]
              },
              "languageCode": "en"
            }, {
              "text": {
                "text": [ "Voulez vous recevoir un SMS ou parler a un Agent?" ]
              },
              "languageCode": "fr-ca"
            }, {
              "text": {
                "text": [ "Désolé, je n'ai pas compris." ]
              },
              "languageCode": "fr-ca"
            } ]
          },
          "name": "b84404e9-3be0-4771-8f56-5bc45f63591b"
        }, {
          "event": "sys.no-match-2",
          "triggerFulfillment": {
            "messages": [ {
              "text": {
                "text": [ "To receive an SMS, press 1.  To speak to an agent, press 2." ]
              },
              "languageCode": "en"
            }, {
              "text": {
                "text": [ "Sorry, I didn't understand that." ]
              },
              "languageCode": "en"
            }, {
              "text": {
                "text": [ "Afin de recevoir un SMS appuyez sur le 1. Pour parler a un agent appuyez sur le 2." ]
              },
              "languageCode": "fr-ca"
            }, {
              "text": {
                "text": [ "Désolé, je n'ai pas compris." ]
              },
              "languageCode": "fr-ca"
            } ]
          },
          "name": "e5fa5e34-bfad-4fc1-a3ae-5e7871b052aa"
        }, {
          "targetPage": "Return To Start",
          "event": "sys.no-match-default",
          "triggerFulfillment": {
            "messages": [ {
              "text": {
                "text": [ "Sorry, I'm still having issues understanding.  Let's start again." ]
              },
              "languageCode": "en"
            }, {
              "text": {
                "text": [ "Désolé, j'ai un peu de difficulté a vous comprendre, recommençons." ]
              },
              "languageCode": "fr-ca"
            } ],
            "setParameterActions": [ {
              "parameter": "return",
              "value": "Y"
            } ]
          },
          "name": "135ef17a-231c-417c-b1f9-bb7b8e0cdd0d"
        } ]
      },
      "advancedSettings": {
        "dtmfSettings": {
          "enabled": true,
          "maxDigits": 1,
          "useSystemEntityRule": false
        }
      }
    } ]
  },
  "entryFulfillment": {
    "setParameterActions": [ {
      "parameter": "sms_flow_status",
      "value": "offered"
    } ]
  },
  "transitionRoutes": [ {
    "intent": "small_talk.confirmation_yes",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "offer_type",
        "value": "sms"
      }, {
        "parameter": "sms_flow_status",
        "value": "sms_offered"
      } ]
    },
    "targetPage": "SMS Accepted",
    "name": "0a447baa-5564-4d25-be62-2088efa0dd90"
  }, {
    "intent": "small_talk.confirmation_no",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "Pour continuer, veuillez sélectionner l'une des options" ]
        },
        "languageCode": "fr-ca"
      } ],
      "setParameterActions": [ {
        "parameter": "smsoragent_retrycnt",
        "value": "$sys.func.ADD($session.params.smsoragent_retrycnt,1)"
      } ]
    },
    "name": "4b135a63-c408-4d93-bcf3-cbf3d8002106"
  }, {
    "intent": "head_intent.live_agent_hand_off",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "Okay let me get someone to help you." ]
        },
        "languageCode": "en"
      }, {
        "text": {
          "text": [ "D'accord, laisse-moi demander à quelqu'un de t'aider." ]
        },
        "languageCode": "fr-ca"
      } ],
      "setParameterActions": [ {
        "parameter": "handoff_type",
        "value": "agent"
      }, {
        "parameter": "sms_flow_status",
        "value": "declined"
      }, {
        "parameter": "smsoragent_check",
        "value": "true"
      } ]
    },
    "targetPage": "Route -\u003e Universal Handoff",
    "name": "fec70c49-0d04-4763-a72a-852711e2b9be"
  }, {
    "intent": "small_talk.nevermind",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "return",
        "value": "Y"
      }, {
        "parameter": "sms_flow_status",
        "value": "declined"
      } ]
    },
    "targetPage": "Return To Start",
    "name": "a437e5ba-e66f-4919-99f2-83a1617d2b80"
  }, {
    "condition": "$session.params.sms_or_agent = \"sms\"",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "offer_type",
        "value": "sms"
      }, {
        "parameter": "sms_flow_status",
        "value": "offered"
      } ]
    },
    "targetPage": "SMS Accepted",
    "name": "f1a9766d-36c1-4d6a-9300-48c646738e4d"
  }, {
    "condition": "$session.params.sms_or_agent = \"agent\"",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "Okay let me get someone to help you." ]
        },
        "languageCode": "en"
      }, {
        "text": {
          "text": [ "D'accord, laisse-moi demander à quelqu'un de t'aider." ]
        },
        "languageCode": "fr-ca"
      } ],
      "setParameterActions": [ {
        "parameter": "handoff_type",
        "value": "agent"
      }, {
        "parameter": "sms_flow_status",
        "value": "declined"
      }, {
        "parameter": "smsoragent_check",
        "value": "true"
      } ]
    },
    "targetPage": "Route -\u003e Universal Handoff",
    "name": "6b76ee87-9322-4c90-8426-eadc2a2d86d8"
  }, {
    "condition": "$session.params.smsoragent_retrycnt = null",
    "triggerFulfillment": {
      "setParameterActions": [ {
        "parameter": "smsoragent_retrycnt",
        "value": 0
      } ]
    },
    "name": "d95b70eb-e3d9-4125-abf1-4b23574b1c76"
  }, {
    "condition": "$session.params.smsoragent_retrycnt \u003e 2",
    "triggerFulfillment": {
      "messages": [ {
        "text": {
          "text": [ "Let me connect you to one of our team member." ]
        },
        "languageCode": "en"
      } ]
    },
    "targetPage": "Route -\u003e Universal Handoff",
    "name": "c0f95fc9-43fa-47a2-bc49-627d3dc73ff9"
  } ],
  "transitionRouteGroups": [ "Repeat1" ]
}
